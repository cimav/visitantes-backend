!!!
%html
  %head
    %title Visitas

    = csrf_meta_tags

    = stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload'
    = javascript_include_tag 'application', 'data-turbolinks-track': 'reload'

    %link( rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous")
    -#
          %script( src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous")
    %script( src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js" integrity="sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4" crossorigin="anonymous")
    %script( src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous")

    %link{:type => "text/css", :rel=>"stylesheet", :href=>"https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.css"}
    %script{:type=>"text/javascript", :src=>"https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.js"}
    %script{:type=>"text/javascript", :src=>"https://cdnjs.cloudflare.com/ajax/libs/jquery-bootgrid/1.3.1/jquery.bootgrid.fa.js"}

    %script{:type=>"text/javascript", :src=>"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.19.1/moment.min.js"}
  %body

    %header
      %div.navbar-fixed
        %nav
          %div.nav-wrapper
            =image_tag "logo-cimav.png", :id=>"img-logo"
            -# %img#img-logo{:src=>"assets/images/logo-cimav.png"}
            %span#titulo-header Administración de visitas
            %ul.right
              %li
                %a{:href=>"#", :title=>"Salir de la aplicación"} Logout

    -# = yield

    %main
      %form.col.s12.forma-filtro
        %div.row
          %div.input-field.col.s3
            %i.material-icons.prefix directions_walk
            %input#apellido.validate{:type=>"text"}
            %label{:for=>"apellido"} Apellido visitante
          %div.input-field.col.s3
            %i.material-icons.prefix business
            %input#empresa.validate{:type=>"text"}
            %label{:for=>"empresa"} Empresa visitante
          %div.input-field.col.s3
            %i.material-icons.prefix portrait
            %input#persona.validate{:type=>"text"}
            %label{:for=>"persona"} Persona a quien visita
        %div.row
          %div.input-field.col.s3
            %i.material-icons.prefix date_range
            -# %input#fecha_inicial.datepicker
            %input#inicial.fechas{:type=>"date"}
            %label{:for=>"fecha_inicial"} Inicio
          %div.input-field.col.s3
            %i.material-icons.prefix date_range
            -# %input#fecha_final.datepicker
            %input#final.fechas{:type=>"date"}
            %label{:for=>"fecha_final"} Fin
        %div#row-btns.right-align
          -# %input( type="button" id="btnFiltrar3" value=" Filtrar " )
          %button#btnFiltrar.btn.btn-default.waves-effect.waves-light{type: "button"}
            Filtrar
            %i.material-icons.right filter_list
          %button#btnExcel.btn.btn-default.waves-effect.waves-light{type: "button"}
            Excel
            %i.material-icons.right file_download

      %div#grid_visitas
        %span De momento, estoy vacio


    %footer.page-footer
      %div.footer-copyright
        %div.container © 2017 Copyright

:javascript

  $(document).ready(function() {

    var today = moment().format('YYYY-MM-DD');
    document.getElementById("inicial").defaultValue = today;
    document.getElementById("final").defaultValue = today;

    // TODO cookies
    var apellido = null;
    var empresa = null;
    var persona = null;

    // al cargar, carga hoy
    var hoy = moment().format('YYYY-MM-DD');
    var url = "main/grid/" + hoy + "/" + hoy + "/" + apellido + "/" + empresa + "/" + persona;
    $.ajax({
      url: url,
      success: function(result){
        $("#grid_visitas").html(result);
      },
      error: function (jqXHR, exception) {
        $("#grid_visitas").html("<h3>Error en el servidor. Al cargar.</h3>");
      }
     });
  });

  /*
  $('.datepicker').pickadate({
    default: 'now',
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 15, // Creates a dropdown of 15 years to control year,
    today: 'Hoy',
    clear: 'Cancelar',
    close: 'Ok',
    closeOnSelect: true // Close upon selecting a date,
  });
  */


    /*
    function buscarTexto() {
      var txt = document.getElementById("busqueda_field").value;
      if ($( "#grid-basic" ).length) {
        $('#grid-basic').bootgrid('search',  txt);
        //$("#grid-basic").bootgrid("destroy").bootgrid("search", "sa uach");
      }
    };
    */



